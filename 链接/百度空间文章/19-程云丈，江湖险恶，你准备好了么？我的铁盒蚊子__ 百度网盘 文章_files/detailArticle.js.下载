/*! 4505 2013-9-22 15:54:28 */
define("pjt/site/page/detailArticle",["lib/jquery/1_9","lib/jh","kit/loadElm","kit/fitImageWidth","pjt/site/transport/all","comp/conf","pjt/site/common/shareDialog","comp/statis","pjt/site/common/editUnitDailog"],function(e,t,n,i,r,a,o,s,c){var d=function(){var i={},a={},d=function(){n(e("body")[0],i),i.isOwner=!!e(i.node.tools).attr("data-is-owner"),i.bindUiEvent()};return i.bindUiEvent=function(){e(".next-article").on("mouseenter",function(){e(this).addClass("next-article-msover")}),e(".next-article").on("mouseleave",function(){e(this).removeClass("next-article-msover")}),e(".prev-article").on("mouseenter",function(){e(this).addClass("prev-article-msover")}),e(".prev-article").on("mouseleave",function(){e(this).removeClass("prev-article-msover")}),e(i.nodes.shareBtn).on("click",function(e){e.preventDefault();var t=i.getShareLink(),n=i.getUnitKey();i.oShareDialog?r.createShareUrl({data:{param:JSON.stringify({records:[n]}),bdstoken:__CONF__.bdstoken},ok:function(){i.oShareDialog.switchToShare(),i.oShareDialog.show()}}):t?i.createDialog({shareLink:t}):i.bBuildingShare||(i.bBuildingShare=!0,r.createShareUrl({data:{param:JSON.stringify({records:[n]}),bdstoken:__CONF__.bdstoken},ok:function(e){i.bBuildingShare=!1,i.createDialog({shareLink:e.data.records[0].link})}}))}),e(i.nodes.editBtn).on("click",function(e){e.preventDefault(),c({key:i.getUnitKey(),ok:function(){i.reloadArticle()}})})},i.getDesc=function(){return e("meta[name=description]").eq(0).attr("content")},i.createDialog=function(e){var n=t.extendObj(e,{showLink:!0,title:i.node.tools.getAttribute("data-title"),showCancelBtn:i.isOwner,key:i.getUnitKey(),desc:i.getDesc()&&" ",pic:i.getTopicPic()});i.oShareDialog=o(n),i.oShareDialog.on("copyComplet",function(){s.trackEvent("文章详情页分享中点击复制链接")}),i.oShareDialog.on("clickShareBtn",function(e,t){s.trackEvent("文章详情页点击分享渠道","按钮"+t.src.getAttribute("data-statis-sign"))}),s.trackEvent("文章详情页中点击分享按钮")},i.reloadArticle=function(){i.node.pcsArticleIframe.src+=""},i.getTopicPic=function(){return e(i.node.tools).attr("data-res-src")},i.getUnitKey=function(){return e(i.node.tools).attr("data-key")},i.getShareLink=function(){return e(i.node.tools).attr("data-link")},d(),a};return d}),requirejs(["pjt/site/page/detailArticle"],function(e){e()});