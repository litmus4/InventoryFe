/*! 5350 2013-11-29 17:1:20 */
define(["lib/jquery/1_9","lib/jh","kit/loadElm","pjt/site/common/dailog","lib/ZeroClipboard","comp/conf","pjt/content_ex/transport/all"],function(e,t,i,n,r,a,s){var o=function(){var t={},o=n.panel.call("extend"),c=function(e){t.key=e.key,t.buildDailog(e),t.buildUiEvent()};switch(t.setShareConf=function(){var t=document.createElement("script");t.id="bdshare_js",t.setAttribute("data","type=tools&amp;uid=6805663"),e("body").append(t),e.getScript("http://bdimg.share.baidu.com/static/js/shell_v2.js")},t.buildDailog=function(n){o._init({title:"分享文章",layoutClass:"share-panel",hold:!0,width:"520",tipsHtml:'<!-- Baidu Button BEGIN --><div class="shareOkTips __shareOkTips">已创建公开链接</div><div class="_copyLink copyLink" style="display:none;"><!-- <span class="bds_more">分享到：</span> --><input type="text" id="shareLink" class="text-input" /><a href="#" class="copyLinkBtn __copyLinkBtn">复制链接</a><a href="#" class="destroyLinkBtn __destroyLinkBtn" style="display:none;"><span>取消公开</span></a><a href="#" class="createLinkBtn __createLinkBtn" style="display:none;"><span>创建公开链接</span></a></div><div id="bdshare" class="bdshare_t bds_tools_32 get-codes-bdshare _shareBtnList""><span><a class="bds_tsina _btn" data-statis-sign="bds_tsina"></a></span><span><a class="bds_qzone _btn" data-statis-sign="bds_qzone"></a></span><span><a class="bds_renren _btn" data-statis-sign="bds_renren"></a></span><span><a class="bds_tqq _btn" data-statis-sign="bds_tqq"></a></span><span><a class="bds_sqq _btn" data-statis-sign="bds_sqq"></a></span></div><!-- Baidu Button END -->'}),i(o.eDailog,t);var r={url:n.shareLink,title:n.title,text:n.title,bdDes:n.desc};n.pic&&(r.pic=n.pic),e(t.node.bdshare).attr("data",JSON.stringify(r)),e(t.node.copyLinkBtn).attr("data-clipboard-text",n.shareLink),e(t.node.shareLink).val(n.shareLink),n.showLink&&t.bindCopyBtn(),n.showCancelBtn&&e(t.node.destroyLinkBtn).show(),t.setShareConf(n)},o.on=function(){var t=e(o);t.on.apply(t,arguments)},t.bindCopyBtn=function(){t.oLinkCopy=new r(t.node.copyLinkBtn,{moviePath:a.staticUrl+"/img/comp/ZeroClipboard.swf",allowScriptAccess:"always",trustedOrigins:[a.baseUrl]}),t.oLinkCopy.on("complete",function(t,i){var n=this;this._srcInnerHTML=this.innerHTML,this.innerHTML="复制成功",e(o).triggerHandler("copyComplet",{content:i.text}),setTimeout(function(){n.innerHTML=n._srcInnerHTML},3e3)}),e(t.nodes.copyLink).show()},t.buildUiEvent=function(){var i=function(){e(t.node.destroyLinkBtn).on("click",function(e){e.preventDefault(),t.destroyLink()}),e(t.node.createLinkBtn).on("click",function(e){e.preventDefault(),t.createLink()}),e("._shareBtnList ._btn",o.eDailog).on("click",t.uiEvent.click_shareBtnList_btn)};return i}(),t.destroyLink=function(){s.destroyShare({data:{param:JSON.stringify({records:[t.key]}),bdstoken:__CONF__.bdstoken},ok:function(){o.switchToPersonal()}})},t.createLink=function(){s.createShareUrl({data:{param:JSON.stringify({records:[t.key],type:"article"}),bdstoken:__CONF__.bdstoken},ok:function(){o.switchToShare()}})},t.uiEvent={click_shareBtnList_btn:function(t){e(o).triggerHandler("clickShareBtn",{src:this,evt:t})}},o.switchToPersonal=function(){e(t.node.shareOkTips).css("visibility","hidden"),e(t.node.bdshare).css("visibility","hidden"),e(t.node.copyLinkBtn).hide(),e(t.node.destroyLinkBtn).hide(),e(t.node.createLinkBtn).show(),e(t.node.shareLink).css("color","#bbb")[0].disabled=!0},o.switchToShare=function(){e(t.node.shareOkTips).css("visibility","visible"),e(t.node.bdshare).css("visibility","visible"),e(t.node.copyLinkBtn).show(),e(t.node.destroyLinkBtn).show(),e(t.node.createLinkBtn).hide(),e(t.node.shareLink).css("color","")[0].disabled=!1},this+""){case"test":o._pri=t;case"extend":o._init=c;break;default:c.apply(o,arguments)}return o};return o});